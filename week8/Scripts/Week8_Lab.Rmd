---
title: "Week8 Lab: Creating Functions"
author: "Shanelle A. Wikramanayake"
date: "3/24/2021"
output: 
  html_document:
    toc: TRUE 
    toc_float: TRUE 
---

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      fig.path = "../Outputs/")
```

##### Use a dataset to make a function for a plot and an equation


### Load Libraries
```{r, warning= FALSE, message=FALSE}

library(tidyverse)
library(here)
library(kableExtra)
library(palmerpenguins)
```

### Check out Palmer Penguins Data
```{r}
view(penguins)
penguins
```
### Function One: Ratio Function
##### Create a function where we make a ratio of two different metrics. var1 is variable 1 and var2 is variable 2.
```{r}
#ratio <- var1/var2 #ratio is variable 1 divided by variable 2

ratio_maker <- function(var1, var2) {
  ratio <- var1/var2
  return(ratio)
} #figure out what argument is aka the known value we add


```
##### We can try it out on bill length and depth to make bill ratio.
 
```{r}
penguins %>% 
  mutate(bill_ratio = ratio_maker(bill_length_mm, bill_depth_mm)) #makes a new column for bill ratio
```
 
### Function Two: Plotting 
##### Plot the Palmer Penguin data so that if the data is two continuous variables, it will give us a line graph. If you specify that the data is discrete with contin = FALSE, it will give us colour coded box plots.
 
```{r}

myplotlab<-function(data = penguins, x, y, z, contin=TRUE ){ #adds true as default for continuous data
  if(contin==TRUE){ #if contin is true then makes a point plot
    ggplot(data = penguins, mapping = aes(x = {{x}}, y = {{y}} , colour = {{z}}))+
      geom_point()+
      geom_smooth(method = "lm")+ 
      scale_color_viridis_d()+   #continuous colour scheme
      theme_bw()
  }
  else{ 
    ggplot(data = penguins, mapping = aes(x = {{x}}, y = {{y}}))+
      geom_boxplot(aes(fill = {{z}}))+
      coord_flip()+
      scale_fill_viridis_d()+   #discrete colour scheme
      theme_bw()
  }
}



```
 
##### Lets try it out on the Palmer Penguins for continuous data
```{r}
myplotlab(x = body_mass_g, y = bill_length_mm, z = species)
```
##### Lets try it out on the Palmer Penguins for discrete data

```{r}
myplotlab(x = species, y = bill_depth_mm, z = island, contin = FALSE)
```
##### Lets make the bill length vs body mass plot look nicer.

```{r}
myplotlab(x = body_mass_g, y = bill_length_mm, z = species)+
  labs(title = "Body mass vs Bill Length", 
       x = "Body Mass (g)", 
       y = "Bill Length (mm)", 
       colour = "Species")
```
##### For the boxplots we can also do this. 

```{r}
myplotlab(x = species, y = bill_depth_mm, z = species, contin = FALSE)+
  labs(title = "Bill Depth Data for Three Penguin Species", 
       x = "Bill Depth (mm)", 
       y = "species")+
  theme(legend.position = "none")
```

